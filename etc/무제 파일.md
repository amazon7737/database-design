
# 4장

```
복잡한 데이터 중에서 일부를 선별해서  병원에서 데이터를 선별하는거 , 가게에서 데이터를 선별하는거 다르다

현실세계에 있는것을 컴퓨터세계로 데이터를 선별해오는 과정을 데이터 모델링이라고 한다

data modeling = 추상화 = 단순화

바로 가져오는게 힘드니까 개념세계를 가운데에 둔다

현실세계 -> 개념세계 -> 컴퓨터세계

현실세계에 있는것을 개념세계로 넘기는거를 개념적 데이터 모델링

개념세계에 있는것을 컴퓨터세계로 넘기는거를 논리적 데이터 모델링

조금더 나아가서 (책의 범위를 나가보면)

컴퓨터 세계 1이 있고 컴퓨터 세계 2가 있음

컴퓨터 세계라고 하는것은 조금더 분할해서 설명을 해야하는데 책에서는 두루뭉실하게 설명을 한것이다

책에서는 물리적인 단계까지 얘기하는게 아니라서 논리적 데이터 모델링이라고 얘기하는것이다

컴퓨터 세계 1 -> 컴퓨터 세계 2 로 넘어가는

데이터 모델링도 있겠네? 라고 생각할 수 있을거임

실제로 있음

이렇게 하면 너무 복잡하니까 하나의 컴퓨터 세계다 라고 보여주는 거임.

왜 논리적 모델링 이라고 단어를 쓸까가 이걸 이해한 부분임

** 모델링과 모델의 차이가 뭐냐
모델링은 ing가 붙어있으니까 설계하는 이런것으로 보일꺼고
모델은 내가 모델링을 하는데 사용하는 도구 로 생각하면 된다

현실세계에 개념을 잡는데 개념을 잡는 과정을 개념적 데이터 모델링이라 하고 그때
사용하는 툴은 개념적 데이터 모델!

사람들이 많이쓰는 도구가 뭐냐 -> 개체 - 관계 모델이다

논리적 데이터 모델링을 하는데 개념 잡은데서 이걸 컴퓨터를 집어넣는 과정을  거칠텐데

논리적 데이터 모델링을 하는 도구가 논리적 데이터 모델이다
관계 데이터 모델,  네트워크 데이터모델, 계층 데이터 모델등 여러가지가 있다

DBMS의 종류와 관련이 있다 1세대 DBMS가 네트워크 데이터 베이스
2세대가 관계 데이터 베이스 ,,  이런 것들이 있었다

트리 형태로 집어넣겠다 계층 DBMS , 테이블 형태로 집어넣겟다 관계 DBMS

개념을 잡은 애를 실제 컴퓨터에 집어 넣을때는 어떤 DBMS 를 사용할 꺼가 결정이 되야 할꺼아니냐

관계 DBMS 를 사용할꺼면 데이터를 관계 데이터 베이스에 맞게 넣어야된다 테이블로

개념적 데이터 모델을 위해서는 개체 관계 모델을 배워야 된다
개체 (Entity) - 관계(Relationship) - 모델(Model)


개념적 데이터 모델 : E-R 다이어그램
논리적 데이터 모델 :  관계형 데이터 베이스




```

<hr>

# 1 - 3장

```


데이터베이스뿐만 아니라 다른 cs에서도 추상화라는 것을

단어를 많이 씀 추상화 -> Abstraction

추상화라는 단어에 익숙해져야된다. 추상화는 다른 말로 쉽게 얘기하면

= Simplefication 단순화 단계라고 한다. 사람이라는 것을 몸 다리 팔이 있다 

단순화해서 단계별로 보여주는 이것을 추상화라고 할 수 있다.

추상화 단계를 낮추면 눈 코 입이 나올 수 있음

추상화라는 것은 전체를 대충 보는것 , 조금 더 자세히 보는것으로 이해

DB를 3단계로 나누었는데 건물로 추상화를 한것이다. 외부 단계 , 개념 단계 , 내부 단계

외부 단계에서 볼때는 집주인 관점이다 

자기 집만 보이는 것

관리인 관점이면 자기 집만 보이는게 아니라 건물 옆 자리 까지 보이는 것

내부 단계에서는 시멘트는 얼마나 부엇고 , 뼈대는 어떻게 세웠는지 이런 것들 건설 업체 관점에서
본다는 것

건물을 무엇이라고 얘기할까 철근이 어떻고 이런 얘기를 하겠냐 

건물을 사용하는 사람 입장에서는 102호만 사용하는 법을 알아라
스위치 어딧고 냉장고 어딧고 이런것만 알면된다

관리인 입장에서는 건물 관리에만 관심이 있고

건설업체 입장에서는 배관이 어딧고 이런것들..

A 에서 쓰는 데이터 B에서 쓰는 데이터 중복 안되게 통합을 한다라는 것을 얘기를 했었다

A부서에서 보는 관점과 B에서 보는 관점이 다를것이다. 하나의 데이터를 보더라도

조금더 복잡한 데이터가 보일 수도 있고 그런 것들

이런 관점들이 외부 단계라고 보면 된다.

주문 관리 부서에서 보는 관점이 잇고 , 마케팅 부서에서 보는 관점이 있고

다 보는 관점이 다를 것이다. 내부 관점에 DB를 본다하면 공부를 더해야 할것이다.

우리는 개념단계 정도까지 관심을 가지면 된다.

각 부서에서 쓰는 데이터들을 중복없이 잘 사용할 수 있도록 하는 것 이것이 개념단계이다.







```

<hr>


```

내부 단계에서는
내부 스키마

레코드 구조 , 레코드 구성하는 필드 크기 , 레코드 접근 경로
이런 물리적인 구조를 저장한다.

고객 분석 팀에서 보는 데이터는 고객의 나이별로 어떤것을 좋아하나
이런 것들이 궁금함

상품배송팀에서는 어디로 어떻게 배송할 꺼냐가 문제기때문에 주소가 궁금하더라

보는 관점이 다르다

그걸 통합해서 하나의 데이터로 모아놓은것이 개념 단계이다


이게 내부단계로 가면 그걸 몇 바이트로 저장할 것인지 이런것들
(콘크리트에 해당하는 건축물 도면에 해당하는 것이다.)
```

<hr>

```
논리적 데이터 독립성

외부 스키마를 안바꿔도 된다

예 ) 3-5 : 스키마 이름을 바꾼다는 말이다 연락처 -> 전화번호 이런식

명칭을 바꾼것이다. 연락처를 달라고 하는데 연락처가 없다

단계를 하나더 거친다 연락처 하고 전화번호 사이에 mapping 정보를 

바꾸는 것이다 연락처를 물으면 전화번호로 찾아와 이런식으로

mapping 정보 : 연락처를 물으면 전화번호로 와라 이런것을 넣어 놓는다

이런 정보를 갖고있겠다 라는 밑에 애가 어떻게 바뀌었다라는 mapping 정보를

갖고있으면 전화번호가 바뀌어도 찾아갈 수 있더라.


```

<hr>

```
물리적 데이터 독립성

개념 외부 사상 정보만 수정해주면 내부스키마가 변경되도 개념 스키마 안바꿔도 됨

개념 외부 사상은 저장 인터페이스 라고도 한다

예 ) 3-5 순서를 바꿔서 두 개념 필드를 바꾸면 

주소랑 연락처 저장하는 순서를 바꾸었다고 하면?

주소 인줄 알고 읽었는데 연락처가 왔다는 것 아니냐

하지만  그 사이에 단계가 하나 있으니까 mapping 정보에 주소를 바꾸어준다

주소는 50에 가면되고 연락처는 30으로 가지면 됩니다

이런식으로 남겨주면 외부에서 볼때는 찾아갈 수 있더라.



```

<hr>

```

부가 정보가 있어야한다 대표적인게 스키마와 mapping(사상 정보)
실제로 데이터는 아니다

데이터를 설명해 주는 데이터 -> 메타 데이터
이것이 30이라는데 고객 번호이다. 이런 명칭들은 데이터들을 설명해주는 데이터
스키마라고도 하는데

나이 데이터에 -20 을 넣게 되면 나이 값에 -20 을 넣었다 이게 개념적으로 
맞는 데이터이냐 나이가 integer 값이 들어와야 되는데 type을 정의해 놨다
-20이 맞으니까 들어온다 근데 이게 맞는 이야기인가?

‘가’를 넣었냐 이건 안된다하는데

-20은? 그렇지 않다
무결성에서 검증을 해야하는데
값이 아무거나 들어온다고 들어오게 해야하는냐 조건이 있어야된다

나이가 일단 0보다 커야된다 최대는 얼마나 될지 모르겟지만 120살 넘는 사람 있으면 안되니
어떻하나

이런 것들을 이런 속성값에 대한 제약 조건이라고 했음

그래서 스키마 안에는 그 속성이 가져야될 제약조건들이 같이 들어간다
이것이 무결성을 지키기 위한 이야기

연락처를 전화번호로 바꾸엇다 -> 이런 mapping 정보를 넣어놓는다 했다? -> 실제 데이터는 아니다 이것도
메타 데이터에 해당

이런 데이터들이 따로 저장해놓는 곳이 데이터 사전이라고 한다 시스템 카탈로그 라고도 한다
(메인 데이터들이랑 따로 분리를 해놓는 다)

시스템 카탈로그를 저장하는 곳을 또 다르게 이곳을 시스템 데이터 베이스라고 한다

일반 데이터들이 저장되는 곳을 사용자 데이터 베이스라고 한다


```

<hr>

```
유저는 DBA 관리자가 있고
우리는 응용프로그래머 -> DB 기본 개념 알고 , 프로그램 언어,  SQL 할줄 알면서
DB를 이용해서 응용 프로그램에서 작업

DBA 는 주로 쓰는 언어 - DDL , DCL (TCL)

TCL 은 Transaction Control Language

응용 
DBA 는 조직내에 사용자들을 위해서 설계 , 구축, 제어
이런 것들을 주로 사용한다  
이분이 하는것은
사용자 요구사항 분석해서 어떤 데이터를 어떻게 구축할것인가

스키마를 정의 -> 주로 개념 스키마를 얘기한다, 각 부서에서 필요한 
외부 스키마도 구축을 한다
관리인 정도로 보면된다

물리적 저장 구조 , 접근 방법 ? -> 내부 스키마

보안 
장애를 대비해서 백업 복구

시스템 데이터베이스 까지도 관리

건물 다 짓고 돌려보면서 시스템 성능을 감시한다

성능이 잘 안될때는 DB 재구성을 한다

사용자는 2가지로 나눈다
캐주얼 사용자 는 SQL DML(Select문)을 쓸줄아는사람
삽입(Insert)
삭제(Delete
수정(Update)
검색(Select)


, 초보 사용자 는 남이짜놓은 거 사용할 수있는 사람

응용 프로그래머는 프로그래밍 언어 할 줄 알고
DML을 알아야한다 SQL 섞어서 쓸 수 있는 사람

보안은 권한을 주는것 이걸 grant 라고 한다 뺏어오는 것은 revoke
DB는 만드는 거니까 create , modify  변경, drop 테이블 삭제

DML에는 Insert , Delete, Update, Select 
이중에서 DML 을 제일 열심히 해야한다
Select 를 되게 열심히 할것이다

DBA가 주로쓰는건 DDL , DCL 임
프로그래머는 DML 하고 DCL을 조금 쓴다
트랜잭션 처리를 해야하니까

DML을 하고나면 이제 캐주얼 사용자가 된다 DB에 궁금한것을
본인이 직접 가져와 볼수 있다

DB안에서 프로그램 짜는 사람 
MySQL 프로그램에서 짜는것보다 오라클에서 짜는사람이 되면 연봉이 높다

절차적인 언어와 비절차적인 언어가 있다

절차적인 언어라고 하면 위에서부터 순서대로 내려간다

비절차적인 언어 SQL 이 있다 how 가 절차적인거임

첫번째에는 어떻게 하고 두번째에는 어떻게 하고..

what 은 아는데 how는 안가르쳐줌 SQL 어떻게 가는지는

모르겠고 알아서 가주세요 택시 아저씨

어떨때는 절차적인게 좋아보이고 어떨때는 비절차적인게 좋아보인다

이런 상황에서는 절차적으로 알려주는 게 좋을 것 같다

DB도 마찬가지다 어떻게 가져올지 까지 말하는거

비절차적인거는 알아서 가져오세요

각자 장단점이 있는데 SQL 은 비절차적인 언어다

회복과 동시성은 트랜잭션과 관련된 부분이라 TCL 로도 본다

```

<hr>


# 1주차

* 데이터 모델링

* 스키마

* 개념적 데이터 모델 => ERD

* 논리적 데이터 모델 => Relational Model

* 이 수업은 바로 변환을 할꺼임 ERD => 스키마 로.

* 책은 절차대로 나와있음 하지만 우리는 그렇게 안할꺼임

* 데이터 모델의 구성 : Data Structure(데이터구조) , Operation(연산) , Contraint(제약조건)

* UML은 프로세스단 설계 , 디비는 ERD 데이터 설계를 하여서 

* 요구사항 분석서는 나중에 소프트웨어 개발에 대한 근거자료로 사용할 수 있을 것같다.

* 개발하면서 요구사항을 갑을 관계로 확인을 받는다.

* 해당 제의 회사에 가서 분석을 하며 요구사항을 뽑아낸다.

* Domain Knowledge


<hr>

# 1주차

```

책에서는 절차적으로 개념적 E-R 모델 , 논리적 관계 모델을 거치면서 진행되도록 되어있지만 현업에서는 한번에 가는 설계를 많이 한다.

ERD에서는 기본적으로 외래키가 없다.
스키마는 N:M 관계가 나온다
ERD를 스키마로 바꾸는 절차를 5단계로 나누고 있다.


```


<hr>


#### 관계

1 . 카디널리티 1:1 , 1:N, N:M

2 . 필수 vs 선택

3 . 식별 vs 비식별



#### 데이터모델링에 관해

ERD1 : 우리가 현재 책에서 공부하고 있는 방식

현실 -> 개념 : ERD1
컴퓨터 세계로 가는것 R.스키마

ERD2 : 우리가 할것 한번에 논리적 모델링까지 완료가 된다

#### ERD1 과 ERD2의 차이점

* 최소 카디널리티는 필수냐 선택이냐에 따라서 갈린다

<img width="536" alt="Pasted image 20230913151541" src="https://github.com/amazon7737/box/assets/76634341/f2201b57-348c-4eed-b018-1a4d834cda4b">


동그라미는 선택 참여로 최대 카디널리티를 나타낸다. 1이라는 뜻을 지닌다

또는

<img width="464" alt="Pasted image 20230913151816" src="https://github.com/amazon7737/box/assets/76634341/e167c59c-d2ad-4395-809b-f6a42800ba10">


저희 부서에는 반드시 사원이 있어야 된다. 필수적 참여로 해달라는 경우도 있다

삼발로 되어있는 사원 앞에 저것은 부서가 최소 0 최대 1인 상태이다

PFK 가 아닌것 같으면 비식별관계이다 FK 이다

PFK는 식별관계이다

1 : N 같은 경우는 굳이 엔티티를 안두고 그냥 관계만 짓는다

책에 있는 다이어그램은 한번만 공급할 수 있계 설계되는 거라 실제로 사용할 수는 없다

optional 은 선택참여이다

글은 반드시 회원이 있어야 하고 최소 0개의 글을 써야한다

<img width="482" alt="Pasted image 20230913152308" src="https://github.com/amazon7737/box/assets/76634341/594ed2e5-e226-47f0-b530-6c453e3aaa5c">


![Pasted image 20230913161356](https://github.com/amazon7737/box/assets/76634341/9dde8ccc-ca95-457a-a0f0-0ac20e6f05f1)


#### 중요! 주문번호

* 비식별 관계로 만들고 PK를 하나로 만든다

PFK 두가지로 될꺼를 PK로 구분을 짓는다

* N:M 관계는 별도의 엔티티가 만들어진다
* PK표현 vs 밑줄
* 관계속성이 기존 테이블로 ..
* 외래키는 1:다로 붙는다

#### 식별 관계는 언제 쓸까?

weak entity 만들때 식별관계로 쓴다

부양가족번호로 하면 비식변관계로 작성 할 수 있다.

Crow - Foot 모델 : 개념적 모델링과 논리적 모델링을 한번에 하는것. 지금 우리가 하고 있는것이 이 모델이다.

* 우리가 생각하는 것 대부분은 비식별 관계이다
* 식별관계는 자주 나오지 않는다


⭐️  식별(PK) 이랑 비식별(FK)이 헷갈린다.

PFK : 좌석이 없으면 비행기도 없다

좌석 => weak entity

* 1:1일때 인스턴스 6곳에 넣기


<hr>


# 식별 vs 비식별 관계

보통 식별 관계인 경우는 강한개체와 약한개체가 만났을때 일어나는데, 명확하게 강한개체와 약한개체가 나누어 지기 때문에 식별관계는 특별한 관계이다.

그래서 일반적으로 비식별 관계가 대부분으로 나타난다.


# 선택참여 vs 필수 참여

항상 관계에 참여하는 것을 필수 참여(Mandatory Membership)이고 선택적으로 관계에 참여하는 것을 선택 참여(Optional Membership)이라고 한다.



<hr>

# 과제 1


고객의 주문 데이터를 관리하는 커피전문점이 있다.
고객은 고객 이름으로 식별되고,주소와 휴대폰번호를 가진다.

하나의 주문은 주문 날짜와 계산을 한 고객으로 식별된다.
그리고 하나의 주문에는 현금,신용카드,수표 등의 지불방식을 기록해야 한다.
각각의 주문은 하나 또는 그 이상의 메뉴항목으로 구성된다.
주문은 각각의 메뉴 항목 단위로 이루어지고,주문 수량도 기록된다.메뉴항목은 항목번호로 식별되고,메뉴항목의 이름과 가격,그리고 커피,차,음료,제과,상품,세트메뉴,상품권,무선인터넷 같은 분류를 가진다. 

하나의 메뉴항목을 준비하는 데는 양도 다르고 종류도 다른 재료가 한 가지 이상 필요하다.
이러한 재료들은 그 이름으로 식별되고,
커피자바는 각각의 재료마다 킬로미터,리터,파운드 같은 주문 단위를 기록하며,양으로 재주문한다.
하나의 재료는 하나 또는 그 이상의 메뉴항목에서 사용될 수 있고,하나의 메뉴항목은 하나 또는 그 이상의 재료로 구성될 수 있다.
요리장은 특별 메뉴 항목에 사용되는 재료가 얼마나 되는지를 파악하고 있어야 한다. 
CEO는 다양한 재료를 제공하는 공급업체 목록을 관리해야 한다.
이들 공급업체들은 그들의 공급업체 번호로 식별되고,공급업체 이름과 주소를 가진다.재료의 가격은 공급업체마다 다르며 공급업체의 납기도 음식재료마다 다르다.




<hr>

# 과제 2


(1) 병원 데이터베이스는 환자와 병원 각 부서로 부터의 입원 및 퇴원, 치료에 대한 데이터를 저장한다.

(2) 각 환자에 대해서는 이름, 주소, 성별, 주민등록번호, 보험코드 등을 알 수 있어야 하고 각 부서에 대해서는 부서명, 위치, 책임자, 병상의 수, 사용 중인 병상의 수를 저장한다.

(3) 각 부서에는 여러 명의 의사들과 간호사가 있으며 의사 중 한 명이 책임자가 된다.

(4) 각 입원 환자에는 담당 의사와 간호사가 있으며 각 의사는 여러 명의 입원 환자를 담당한다. 반면에 간호사는 여러 병의 환자를 담당하고 각 환자는 한 명의 의사와 여러 명의 간호사로부터 관리를 받는다.

(5) 각 의사와 간호사에 대해서는 사원번호, 이름, 주민등록번호, 재직연수 등의 정보가 있다.

(6) 각 환자들은 지정된 날짜에 입, 퇴원하며 입원기간 동안 여러 번의 치료를 받는다.

(7) 치료에 대해서는 치료명, 기간, 환자가 보일 수 있는 반응 등을 저장한다.

<hr>

# 과제 3


(1) TC는 여러 개의 단과대학(school)으로 나뉜다. 각 단과대학은 학장(dean)이 반드시 한 명 있어야 하며, 각 학장은 반드시 한 단과대학만 관리할 수 있다. 각 단과대학은 여러 개의 학과(department)로 나뉘며 각 학과는 반드시 한 단과대학에만 소속되어 있다.

(2) 각 학과에는 반드시 여러 개(1개 이상)의 과목(course)들이 제공(offer)된다. 각 학과는 같은 과목에 대해서 여러 반(class)을 개설할 수 있다. 각 반은 주어진 장소에서 주어진 시간에 한 교수(professor)에 의해 가르쳐진다.

(3) 각 학과는 반드시 여러 명(1명 이상)의 교수들이 있고, 각 교수는 반드시 하나의 학과에 속한다. 각 학과는 단 한 명의 학과장(chair)이 있어야 하는데, 모든 교수가 다 학과장이 될 수는 없다.

(4) 각 교수는 4반까지 강의(teach)할 수 있으며, 어떤 교수는 그 학기에 강의를 안 할 수도 있다.

(5) 한 학생은 반드시 등록(enroll)을 하되 6개의 반까지 등록할 수 있고 한 반은 등록 기간에 반드시 한 번만 선택할 수 있다.

(6) 각 학과에는 여러 명(최소한 1명)의 학생이 있으며, 각 학생의 전공은 한 학과에만 속해야 한다.

(7) 각 학생은 반드시 소속된 학과의 지도 교수가 있다. 지도 교수는 여러 학생을 지도(advise)할 수 있으나, 반드시 지도해야 하는 것은 아니다.

<hr>

#### Chen 표기법에서의 테이블 분리에 대해서

<img width="612" alt="Pasted image 20230926215931" src="https://github.com/amazon7737/box/assets/76634341/512c96c2-7d8a-4a52-aba6-4e9c97903add">



왠만하면 방법 1처럼 진행하는게 좋다

방법2 처럼하게 되면 조인을 많이 해야하는 경우가 생긴다

# 디비 설계 식별자

* 인위적 식별자는 의미 부여 하지않고 , 종속되지 않는다

* 식별자 하면 "인덱스"이다

* 예를 들어 ) 속성값 2개 PK가 있다, 자주 사용하는 속성이 먼저 오게해서 순서를 맞춰야한다. 속도에서 차이가 있다

* 마땅한 주식별자가 없는 경우에는 인위적 식별자를 생성한다

* 슈퍼키를 기본키로 쓰면 주의 해야하는 부분은?


# 카디널리티에 대해서

#### Maximal 카디널리티

1:1 관계에서는 굉장히 특이한 경우가 많다 합칠 수 있는가를 고민해볼 필요가 있다

1:N

N:M 관계에서는 1:N & N:1 관계라고 생각하면 편하다


#### Minimal 카디널리티

관계에 있는 두 엔티티의 인스턴스들이 항상 관게에 참여 하는지 아니면 경우에 따라 관계에 참여하는지

<img width="546" alt="Pasted image 20230927134703" src="https://github.com/amazon7737/box/assets/76634341/0c43f158-ac0c-4dbb-b024-6ec82d271319">



#### 정리하자면,,

* 대부분의 관계는 1:N관계이다

* M:N 관계는 아직 완성되지 않은 작업으로 간주되며, M:N 관계를 해소하기 위한 추가 작업이 필요하다

* 부서와 사원이 있다고 하면, 모든 사원은 반드시 부서를 가지고 단 하나의 부서에 소속된다 , 어떤 부서는 특정 시점에서 사원이 없을 수도 있고 있는 경우*


#### 식별 / 비식별

약한 엔티티 입장에서는 : 강한 개체가 없으면 약한 개체도 없다

ex) 비행기 => 좌석

weak이라고 해서 무조건 식별 X 하지만 대부분 식별이다

강한 개체를 참조하는 존재가 바로 약한 개체이다

영수증 사진 꼭 그려봐라


* 순환관계는 rollname으로 해라






